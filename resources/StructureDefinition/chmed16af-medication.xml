<?xml version="1.0" encoding="UTF-8"?>
<StructureDefinition 
  xmlns="http://hl7.org/fhir">
  <id value="chmed16af-medication"/>
  <url value="http://emediplan.ch/fhir/chmed16af/StructureDefinition/chmed16af-medication" />
  <name value="Medication"/>
  <title value="Medication"/>
  <status value="draft"/>
	<publisher value="IG eMediplan" />
	<contact>
		<telecom>
			<system value="url"/>
			<value value="http://www.emediplan.ch"/>
		</telecom>
	</contact>
	<description value="Profile on Medication"/>
	<fhirVersion value="3.0.0" />
  <mapping>
    <identity value="CHMED16A"/>
    <uri value="http://emediplan.ch/chmed16a"/>
    <name value="Mapping to CHMED16A"/>
  </mapping>
  <kind value="resource"/>
  <abstract value="false"/>
  <type value="Medication"/>
  <baseDefinition value="http://hl7.org/fhir/StructureDefinition/Medication"/>
  <derivation value="constraint"/>
  <differential>
    <element id="Medication">
      <path value="Medication"/>
      <short value="Definition of a Medication"/>
      <definition value="This resource is primarily used for the identification and definition of a medication. It covers the ingredients and the packaging for a medication."/>
      <min value="0"/>
      <max value="*"/>
    </element>
    <element id="Medication.code">
      <path value="Medication.code"/>
      <short value="GTIN Codes that identify this medication"/>
      <definition value="A code (or set of codes) that specify this medication, or a textual description if no code is available. Usage note: The GTIN code is used for identification"/>
      <comment value="-" />
      <min value="0"/>
      <max value="1"/>
      <type>
        <code value="CodeableConcept"/>
      </type>
      <isSummary value="true"/>
      <binding>
        <extension url="http://hl7.org/fhir/StructureDefinition/elementdefinition-bindingName">
          <valueString value="MedicationFormalRepresentation"/>
        </extension>
        <strength value="required"/>
        <description value="Using GTIN for identification of medication"/>
        <valueSetUri value="urn:oid:2.51.1.1" />
      </binding>
      <mapping>
        <identity value="CHMED16A"/>
        <map value="Medication.ID with IdTpye 2 (GTIN)"/>
      </mapping>
    </element>
    <element id="Medication.status">
      <path value="Medication.status"/>
      <short value="active | inactive | entered-in-error"/>
      <definition value="A code to indicate if the medication is in active use."/>
      <comment value="This status is not intended to specify if a medication is part of a formulary."/>
      <min value="0"/>
      <max value="0"/>
      <type>
        <code value="code"/>
      </type>
    </element>
    <element id="Medication.isBrand">
      <path value="Medication.isBrand"/>
      <short value="True if a brand"/>
      <definition value="Set to true if the item is attributable to a specific manufacturer."/>
      <min value="0"/>
      <max value="0"/>
      <type>
        <code value="boolean"/>
      </type>
    </element>
    <element id="Medication.isOverTheCounter">
      <path value="Medication.isOverTheCounter"/>
      <short value="True if medication does not require a prescription"/>
      <definition value="Set to true if the medication can be obtained without an order from a prescriber."/>
      <min value="0"/>
      <max value="0"/>
      <type>
        <code value="boolean"/>
      </type>
    </element>
    <element id="Medication.manufacturer">
      <path value="Medication.manufacturer"/>
      <short value="Manufacturer of the item"/>
      <definition value="Describes the details of the manufacturer of the medication product.  This is not intended to represent the distributor of a medication product."/>
      <min value="0"/>
      <max value="0"/>
      <type>
        <code value="Reference"/>
        <targetProfile value="http://hl7.org/fhir/StructureDefinition/Organization"/>
      </type>
    </element>
    <element id="Medication.form">
      <path value="Medication.form"/>
      <short value="powder | tablets | capsule +"/>
      <definition value="Describes the form of the item.  Powder; tablets; capsule."/>
      <comment value="When Medication is referenced from MedicationRequest, this is the ordered form.  When Medication is referenced within MedicationDispense, this is the dispensed form.  When Medication is referenced within MedicationRequest, this is administered form."/>
      <min value="0"/>
      <max value="0"/>
      <type>
        <code value="CodeableConcept"/>
      </type>
    </element>
    <element id="Medication.ingredient">
      <path value="Medication.ingredient"/>
      <short value="Active or inactive ingredient"/>
      <definition value="Identifies a particular constituent of interest in the product."/>
      <comment value="The ingredients need not be a complete list.  If an ingredient is not specified, this does not indicate whether an ingredient is present or absent.  If an ingredient is specified it does not mean that all ingredients are specified.  It is possible to specify both inactive and active ingredients."/>
      <min value="0"/>
      <max value="0"/>
      <type>
        <code value="BackboneElement"/>
      </type>
    </element>
    <element id="Medication.package">
      <path value="Medication.package"/>
      <short value="Details about packaged medications"/>
      <definition value="Information that only applies to packages (not products)."/>
      <min value="0"/>
      <max value="0"/>
      <type>
        <code value="BackboneElement"/>
      </type>
    </element>
    <element id="Medication.image">
      <path value="Medication.image"/>
      <short value="Picture of the medication"/>
      <definition value="Photo(s) or graphic representation(s) of the medication."/>
      <requirements value="Note that &quot;image&quot; is only applicable when the medication.code represents a physical item (e.g. Amoxil 250 mg capsule) and not an abstract item (e.g. amoxicillin 250 mg)."/>
      <min value="0"/>
      <max value="0"/>
      <type>
        <code value="Attachment"/>
      </type>
      <mapping>
        <identity value="rim"/>
        <map value=".participation[typeCode=SUBJ].role[classCode=MANU],source[classCode=OBS,moodCode=EVN,code=&quot;type of image&quot;].value(ED.image)"/>
      </mapping>
    </element>
  </differential>
</StructureDefinition>