<StructureDefinition xmlns="http://hl7.org/fhir">
   <id value="chmed16af-rx-composition"/>
   <url value="http://chmed16af.emediplan.ch/fhir/StructureDefinition/chmed16af-rx-composition"/>
   <version value="0.1.0"/>
   <name value="CompositionPrescription"/>
   <title value="Composition Prescription"/>
   <status value="draft"/>
   <publisher value="IG eMediplan"/>
   <contact>
      <telecom>
         <system value="url"/>
         <value value="http://www.emediplan.ch"/>
      </telecom>
   </contact>
   <description value="Profile for the Composition Resource of the prescripton."/>
   <fhirVersion value="4.0.0"/>
   <mapping>
      <identity value="CHMED16A"/>
      <uri value="http://emediplan.ch/chmed16a"/>
      <name value="Mapping to CHMED16A"/>
   </mapping>
   <kind value="resource"/>
   <abstract value="false"/>
   <type value="Composition"/>
   <baseDefinition value="http://hl7.org/fhir/StructureDefinition/Composition"/>
   <derivation value="constraint"/>
   <differential>
      <element id="Composition">
         <path value="Composition"/>
         <min value="1"/>
         <max value="1"/>
         <mapping>
            <identity value="CHMED16A"/>
            <map value="Medication"/>
         </mapping>
      </element>
      <element id="Composition.extension">
         <path value="Composition.extension"/>
         <slicing>
            <discriminator>
               <type value="value"/>
               <path value="url"/>
            </discriminator>
            <rules value="open"/>
         </slicing>
      </element>
      <element id="Composition.extension:privatefield">
         <path value="Composition.extension" />
         <sliceName value="privatefield" />
         <short value="Private fields for patient"/>
         <min value="0"/>
         <max value="*"/>
         <type>
            <code value="Extension" />
            <profile value="http://chmed16af.emediplan.ch/fhir/StructureDefinition/chmed16af-privatefield" />
         </type>
         <mapping>
            <identity value="CHMED16A"/>
            <map value="Private Fields"/>
         </mapping>
      </element>
      <element id="Composition.identifier">
         <path value="Composition.identifier"/>
         <short value="Logical identifier for document (GUID)"/>
         <definition value="Logical identifier for document (GUID)"/>
         <comment value="-"/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="Identifier"/>
         </type>
         <mapping>
            <identity value="CHMED16A"/>
            <map value="id"/>
         </mapping>
      </element>
      <element id="Composition.type">
         <path value="Composition.type"/>
      </element>
      <element id="Composition.type.coding">
         <path value="Composition.type.coding"/>
      </element>
      <element id="Composition.type.coding.system">
         <path value="Composition.type.coding.system"/>
         <fixedUri value="http://emediplan.ch/chmed16af/doc"/>
      </element>
      <element id="Composition.type.coding.code">
         <path value="Composition.type.coding.code"/>
         <fixedCode value="RX"/>
      </element>
      <element id="Composition.subject">
         <path value="Composition.subject"/>
         <short value="Reference to the Patient"/>
         <definition value="Reference to the Patient."/>
         <comment value="-"/>
         <requirements value="Essential metadata for searching for the composition. Identifies who and/or what the composition/document is about."/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="Reference"/>
            <targetProfile value="http://chmed16af.emediplan.ch/fhir/StructureDefinition/chmed16af-pmcrx-patient"/>
         </type>
         <mapping>
            <identity value="CHMED16A"/>
            <map value="Patient"/>
         </mapping>
      </element>
      <element id="Composition.encounter">
         <path value="Composition.encounter"/>
         <short value="Context of the Composition"/>
         <definition value="Describes the clinical encounter or type of care this documentation is associated with."/>
         <requirements value="Provides context for the composition and supports searching."/>
         <min value="0"/>
         <max value="0"/>
      </element>
      <element id="Composition.date">
         <path value="Composition.date"/>
         <short value="Composition editing time"/>
         <definition value="The composition editing time, when the composition was last logically changed by the author."/>
         <comment value="The Last Modified Date on the composition may be after the date of the document was attested without being changed."/>
         <requirements value="dateTime is used for tracking, organizing versions and searching."/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="dateTime"/>
         </type>
         <mapping>
            <identity value="CHMED16A"/>
            <map value="DT"/>
         </mapping>
      </element>
      <element id="Composition.author">
         <path value="Composition.author"/>
         <short value="Author (Gln if available, otherwise name)"/>
         <definition value="Author (Gln if available, otherwise name)"/>
         <requirements value="Identifies who is responsible for the content."/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="Reference"/>
            <targetProfile value="http://chmed16af.emediplan.ch/fhir/StructureDefinition/chmed16af-practitioner"/>
         </type>
         <mapping>
            <identity value="CHMED16A"/>
            <map value="Auth"/>
         </mapping>
      </element>
      <element id="Composition.title">
         <path value="Composition.title"/>
         <short value="Human Readable name/title"/>
         <definition value="Official human-readable label for the composition."/>
         <comment value="For many compositions, the title is the same as the text or a display name of Composition.type (e.g. a &quot;consultation&quot; or &quot;progress note&quot;). Note that CDA does not make title mandatory, but there are no known cases where it is useful for title to be omitted, so it is mandatory here. Feedback on this requirement is welcome during the trial use period."/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="string"/>
         </type>
      </element>
      <element id="Composition.confidentiality">
         <path value="Composition.confidentiality"/>
         <short value="As defined by affinity domain"/>
         <definition value="The code specifying the level of confidentiality of the Composition."/>
         <comment value="The exact use of this element, and enforcement and issues related to highly sensitive documents are out of scope for the base specification, and delegated to implementation profiles (see security section)."/>
         <min value="0"/>
         <max value="0"/>
         <type>
            <code value="code"/>
         </type>
         <isModifier value="true"/>
         <isModifierReason value="No Modifier Reason provideed in previous versions of FHIR"/>
      </element>
      <element id="Composition.attester">
         <path value="Composition.attester"/>
         <short value="Attests to accuracy of composition"/>
         <definition value="A participant who has attested to the accuracy of the composition/document."/>
         <comment value="Only list each attester once."/>
         <requirements value="Identifies responsibility for the accuracy of the composition content."/>
         <min value="0"/>
         <max value="0"/>
         <type>
            <code value="BackboneElement"/>
         </type>
      </element>
      <element id="Composition.custodian">
         <path value="Composition.custodian"/>
         <short value="Organization which maintains the composition"/>
         <definition value="Identifies the organization or group who is responsible for ongoing maintenance of and access to the composition/document information."/>
         <comment value="This is useful when documents are derived from a composition - provides guidance for how to get the latest version of the document. This is optional because this is sometimes not known by the authoring system, and can be inferred by context. However it is important that this information be known when working with a derived document, so providing a custodian is encouraged."/>
         <requirements value="Identifies where to go to find the current version, where to report issues, etc."/>
         <min value="0"/>
         <max value="0"/>
         <type>
            <code value="Reference"/>
            <targetProfile value="http://hl7.org/fhir/StructureDefinition/Organization"/>
         </type>
         <mapping>
            <identity value="rim"/>
            <map value=".participation[typeCode=&quot;RCV&quot;].role[classCode=&quot;CUST&quot;].scoper[classCode=&quot;ORG&quot; and determinerCode=&quot;INST&quot;]"/>
         </mapping>
         <mapping>
            <identity value="cda"/>
            <map value=".custodian.assignedCustodian"/>
         </mapping>
      </element>
      <element id="Composition.relatesTo">
         <path value="Composition.relatesTo"/>
         <short value="Relationships to other compositions/documents"/>
         <definition value="Relationships that this composition has with other compositions or documents that already exist."/>
         <comment value="A document is a version specific composition."/>
         <min value="0"/>
         <max value="0"/>
         <type>
            <code value="BackboneElement"/>
         </type>
         <constraint>
            <key value="ele-1"/>
            <severity value="error"/>
            <human value="All FHIR elements must have a @value or children"/>
            <expression value="children().count() > id.count()"/>
            <xpath value="@value|f:*|h:div"/>
            <source value="Element"/>
         </constraint>
         <mapping>
            <identity value="rim"/>
            <map value=".outboundRelationship"/>
         </mapping>
         <mapping>
            <identity value="cda"/>
            <map value=".relatedDocument"/>
         </mapping>
      </element>
      <element id="Composition.event">
         <path value="Composition.event"/>
         <short value="The clinical service(s) being documented"/>
         <definition value="The clinical service, such as a colonoscopy or an appendectomy, being documented."/>
         <comment value="The event needs to be consistent with the type element, though can provide further information if desired."/>
         <requirements value="Provides context for the composition and creates a linkage between a resource describing an event and the composition created describing the event."/>
         <min value="0"/>
         <max value="0"/>
         <type>
            <code value="BackboneElement"/>
         </type>
         <constraint>
            <key value="ele-1"/>
            <severity value="error"/>
            <human value="All FHIR elements must have a @value or children"/>
            <expression value="children().count() > id.count()"/>
            <xpath value="@value|f:*|h:div"/>
            <source value="Element"/>
         </constraint>
         <mapping>
            <identity value="rim"/>
            <map value="outboundRelationship[typeCode=&quot;SUBJ&quot;].target[classCode&lt;'ACT']"/>
         </mapping>
         <mapping>
            <identity value="cda"/>
            <map value=".documentationOf.serviceEvent"/>
         </mapping>
      </element>
      <element id="Composition.section">
         <path value="Composition.section"/>
         <slicing>
            <discriminator>
               <type value="value"/>
               <path value="code.coding.code"/>
            </discriminator>
            <ordered value="true"/>
            <rules value="closed"/>
         </slicing>
         <min value="2"/>
         <max value="3"/>
      </element>
      <element id="Composition.section:sectionmed">
         <path value="Composition.section"/>
         <sliceName value="sectionmed"/>
         <min value="1"/>
         <max value="1"/>
         <mapping>
            <identity value="CHMED16A"/>
            <map value="Medication.Medicaments"/>
         </mapping>
      </element>
      <element id="Composition.section.codesectionmed">
         <path value="Composition.section.code"/>
         <min value="1"/>
         <max value="1"/>
      </element>
      <element id="Composition.section.code.coding:sectionmed">
         <path value="Composition.section.code.coding"/>
         <min value="1"/>
         <max value="1"/>
      </element>
      <element id="Composition.section.code.coding.system:sectionmed">
         <path value="Composition.section.code.coding.system"/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="uri"/>
         </type>
         <fixedUri value="http://loinc.org"/>
      </element>
      <element id="Composition.section.code.coding.code:sectionmed">
         <path value="Composition.section.code.coding.code"/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="code"/>
         </type>
         <fixedCode value="57828-6"/>
      </element>
      <element id="Composition.section.code.coding.display:sectionmed">
         <path value="Composition.section.code.coding.display"/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="string"/>
         </type>
         <fixedString value="PRESCRIPTIONS"/>
      </element>
      <element id="Composition.section.entry:sectionmed">
         <path value="Composition.section.entry"/>
         <short value="A reference to data that supports this section"/>
         <definition value="A reference to the actual resource from which the narrative in the section is derived."/>
         <comment value="If there are no entries in the list, an emptyReason SHOULD be provided."/>
         <min value="0"/>
         <max value="*"/>
         <type>
            <code value="Reference"/>
            <targetProfile value="http://chmed16af.emediplan.ch/fhir/StructureDefinition/chmed16af-rx-medicationrequest"/>
         </type>
      </element>
      <element id="Composition.section:sectionnote">
         <path value="Composition.section"/>
         <sliceName value="sectionnote"/>
         <min value="1"/>
         <max value="1"/>
         <mapping>
            <identity value="CHMED16A"/>
            <map value="Medication.Rmk"/>
         </mapping>
      </element>
      <element id="Composition.section.code:sectionnote">
         <path value="Composition.section.code"/>
         <min value="1"/>
         <max value="1"/>
      </element>
      <element id="Composition.section.code.coding:sectionnote">
         <path value="Composition.section.code.coding"/>
         <min value="1"/>
         <max value="1"/>
      </element>
      <element id="Composition.section.code.coding.system:sectionnote">
         <path value="Composition.section.code.coding.system"/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="uri"/>
         </type>
         <fixedUri value="http://loinc.org"/>
      </element>
      <element id="Composition.section.code.coding.code:sectionnote">
         <path value="Composition.section.code.coding.code"/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="code"/>
         </type>
         <fixedCode value="48767-8"/>
      </element>
      <element id="Composition.section.code.coding.display:sectionnote">
         <path value="Composition.section.code.coding.display"/>
         <min value="1"/>
         <max value="1"/>
         <type>
            <code value="string"/>
         </type>
         <fixedString value="ANNOTATION COMMENT"/>
      </element>
      <element id="Composition.section.entry:sectionnote">
         <path value="Composition.section.entry"/>
         <short value="A reference to data that supports this section"/>
         <definition value="A reference to the actual resource from which the narrative in the section is derived."/>
         <comment value="If there are no entries in the list, an emptyReason SHOULD be provided."/>
         <min value="0"/>
         <max value="1"/>
         <type>
            <code value="Reference"/>
            <targetProfile value="http://hl7.org/fhir/StructureDefinition/Resource"/>
         </type>
      </element>
   </differential>
</StructureDefinition>